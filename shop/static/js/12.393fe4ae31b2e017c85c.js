webpackJsonp([12],{"9LPF":function(e,r){},lCEq:function(e,r,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={data:function(){return{ruleForm:{name:"",phone:"",role_id:[],company_id:""},branchCompanys:[],filtersRole:{headquarters:[],branch:[],other:[]},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:3,max:16,message:"长度在 3 到 16 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入用户手机号码",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号格式不对"}],company_id:[{required:!0,message:"请选择所属分公司",trigger:"blur"}]}}},mounted:function(){var e=this,r=[3,5,6,7,8,9,10,11,12,13,14],l=this.filtersRole;this.$get("roles").then(function(e){e.roles.forEach(function(e){r.forEach(function(r){r==e.roleId&&(e.disabled=!0)}),[1,2,3].indexOf(parseInt(e.roleId))>=0?l.headquarters.push(e):[4,5,6,7,8,9,10].indexOf(parseInt(e.roleId))>=0?l.branch.push(e):l.other.push(e)})}),this.$get("offices").then(function(r){e.branchCompanys=r.branchCompanys})},methods:{goBack:function(){this.$router.back()},userNew:function(){var e=this;this.$refs.ruleForm.validate(function(r){if(r){var l=[];e.ruleForm.role_id.forEach(function(r){l.push({roleId:r,userId:e.ruleForm.phone,roleStatus:"1"})}),e.$post("users",{userName:e.ruleForm.name,userId:e.ruleForm.phone,userRoles:l,tenantId:e.ruleForm.company_id}).then(function(r){e.$alert("新建成功","新建用户",{confirmButtonText:"确定",callback:function(r){e.$router.back()}})})}})}}},a={render:function(){var e=this,r=e.$createElement,l=e._self._c||r;return l("el-card",{staticClass:"heightfull"},[l("el-row",[l("el-page-header",{attrs:{content:"新建用户"},on:{back:e.goBack}})],1),e._v(" "),l("el-row",{staticClass:"df aic jcc"},[l("el-col",{attrs:{span:18}},[l("el-row",{staticClass:"mt10 df form"},[l("el-col",{attrs:{span:22,offset:1}},[l("el-form",{ref:"ruleForm",staticClass:"mt20",attrs:{model:e.ruleForm,rules:e.rules}},[l("el-row",[l("el-col",{attrs:{span:3}},[l("span",{staticClass:"form_name_must"},[e._v("用户名称")])]),e._v(" "),l("el-col",{attrs:{span:21}},[l("el-form-item",{attrs:{prop:"name"}},[l("el-input",{attrs:{placeholder:"请输入用户名称",maxlength:"16"},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:3}},[l("span",{staticClass:"form_name_must"},[e._v("手机号码")])]),e._v(" "),l("el-col",{attrs:{span:21}},[l("el-form-item",{attrs:{prop:"phone"}},[l("el-input",{attrs:{placeholder:"请输入手机号码",maxlength:"11"},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:3}},[l("span",{staticClass:"form_name_must"},[e._v("所属公司")])]),e._v(" "),l("el-col",{attrs:{span:21}},[l("el-form-item",{attrs:{prop:"company_id"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.company_id,callback:function(r){e.$set(e.ruleForm,"company_id",r)},expression:"ruleForm.company_id"}},e._l(e.branchCompanys,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:3}},[l("span",{staticClass:"form_name pl10"},[e._v("角色分配")])]),e._v(" "),l("el-col",{attrs:{span:21}},[l("el-form-item",[l("el-row",{staticClass:"df"},[l("el-col",{attrs:{span:8}},[l("el-checkbox-group",{staticClass:"df ffcw",attrs:{size:"small"},model:{value:e.ruleForm.role_id,callback:function(r){e.$set(e.ruleForm,"role_id",r)},expression:"ruleForm.role_id"}},e._l(e.filtersRole.headquarters,function(r){return l("el-checkbox",{key:r.roleId,attrs:{label:r.roleId,disabled:r.disabled}},[e._v(e._s(r.roleName))])}),1)],1),e._v(" "),l("el-col",{attrs:{span:8}},[l("el-checkbox-group",{staticClass:"df ffcw",attrs:{size:"small"},model:{value:e.ruleForm.role_id,callback:function(r){e.$set(e.ruleForm,"role_id",r)},expression:"ruleForm.role_id"}},e._l(e.filtersRole.branch,function(r){return l("el-checkbox",{key:r.roleId,attrs:{label:r.roleId,disabled:r.disabled}},[e._v(e._s(r.roleName))])}),1)],1),e._v(" "),l("el-col",{attrs:{span:8}},[l("el-checkbox-group",{staticClass:"df ffcw",attrs:{size:"small"},model:{value:e.ruleForm.role_id,callback:function(r){e.$set(e.ruleForm,"role_id",r)},expression:"ruleForm.role_id"}},e._l(e.filtersRole.other,function(r){return l("el-checkbox",{key:r.roleId,attrs:{label:r.roleId,disabled:r.disabled}},[e._v(e._s(r.roleName))])}),1)],1)],1)],1)],1)],1),e._v(" "),l("el-row",{staticClass:"mb40"},[l("el-col",{staticClass:"df aic jcc",attrs:{span:19,offset:3}},[l("el-button",{staticClass:"w06",attrs:{type:"primary"},on:{click:function(r){return e.userNew()}}},[e._v("确认")])],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var s=l("VU/8")(t,a,!1,function(e){l("9LPF")},"data-v-358aaca7",null);r.default=s.exports}});
//# sourceMappingURL=12.393fe4ae31b2e017c85c.js.map