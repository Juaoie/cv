webpackJsonp([4],{yqAO:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){return{tableData:[],filtersRoles:[],filtersFaculties:[],filters:{filtersRole:[],filtersStatus:[]},keywords:"",total:0,current_page:1,page_size:5}},mounted:function(){var e=this;this.$post("user/getgroupid").then(function(t){t.roles.forEach(function(e){e.text=e.role_name,e.value=e.role_id}),t.faculties.forEach(function(e){e.text=e.faculty_name,e.value=e.faculty_id}),e.filtersRoles=t.roles,e.filtersFaculties=t.faculties})},methods:{binFilters:function(e){console.log(e),"roles"in e&&(this.filters.filtersRole=e.roles),"faculties"in e&&(this.filters.filtersStatus=e.faculties)},new_user:function(){this.$router.push({path:"/page/user/userNew",query:{}})},change_info_user:function(e){this.$router.push({path:"/page/user/userInfoChange",query:{}})},orle_user:function(){this.$router.push("/page/user/userRole")},search:function(){var e=this;this.$get("users/keywords",{keywords:this.keywords,current_page:this.current_page,page_size:this.page_size}).then(function(t){e.$refs.filterTable.clearFilter(),e.filters.filtersRole=[],e.filters.filtersStatus=[],e.filters.filtersOffice=[],e.tableData=t.data,e.total=t.total})},handleDelete:function(e,t){var s=this;this.$confirm("确定"+("1"==e.status?"停用":"启用")+"用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$put("1"==e.status?"users/freezeUser":"users/unFreezeUser",{id:e.id}).then(function(e){s.getUsersList()})})},tableRowClassName:function(e){var t=e.row,s=(e.rowIndex,[]);return t.userRoles.forEach(function(e){s.push(e.roleName)}),t.role=s.join(","),"1"==t.status?t.status_text="可用":"2"==t.status&&(t.status_text="停用"),"2"==t.status?"warning-row":""},handleSizeChange:function(e){this.page_size=e,this.getUsersList()},handleCurrentChange:function(e){this.current_page=e,this.getUsersList()},getUsersList:function(){var e=this;this.filters.filtersRole.length||this.filters.filtersOffice.length||this.filters.filtersStatus.length?this.$get("users/filter",{roleId:this.filters.filtersRole.join(","),status:this.filters.filtersStatus[0],tenantId:this.filters.filtersOffice.join(","),current_page:1,page_size:this.page_size}).then(function(t){e.tableData=t.data,e.total=t.total,e.keywords=""}):this.$get("users",{current_page:this.current_page,page_size:this.page_size}).then(function(t){e.tableData=t.data,e.total=t.total})}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{placeholder:"请输入用户名称/手机号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1),e._v(" "),s("el-col",{attrs:{span:5,offset:12}},[s("el-button",{attrs:{type:"primary"},on:{click:e.new_user}},[e._v("新建用户")])],1)],1),e._v(" "),s("el-row",{staticClass:"mtb10"},[s("el-table",{ref:"filterTable",staticClass:"w24",attrs:{data:e.tableData,border:"",height:"500px","default-sort":{prop:"userName",order:"descending"},"row-class-name":e.tableRowClassName},on:{"filter-change":e.binFilters}},[s("el-table-column",{attrs:{prop:"userName",label:"用户名称",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"userId",label:"手机号码"}}),e._v(" "),s("el-table-column",{attrs:{prop:"roles",label:"角色",filters:e.filtersRoles,"column-key":"roles"}}),e._v(" "),s("el-table-column",{attrs:{prop:"faculties",label:"院系",filters:e.filtersFaculties,"column-key":"faculties"}}),e._v(" "),s("el-table-column",{attrs:{prop:"clazzs",label:"班级"}}),e._v(" "),s("el-table-column",{attrs:{prop:"status_text",label:"状态",filters:[{text:"可用",value:"1"},{text:"停用",value:"2"}],"column-key":"status","filter-multiple":!1}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.change_info_user(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.orle_user(t.$index,t.row)}}},[e._v("角色分配")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:1==t.row.status?"primary":"danger"},on:{click:function(s){return e.handleDelete(t.row,t.$index)}}},[e._v("功能"+e._s(1==t.row.status?"停用":"可用"))])]}}])})],1)],1),e._v(" "),s("el-row",{staticClass:"mt10 df jcfe"},[s("el-pagination",{attrs:{"current-page":e.current_page,"page-sizes":[5,50,100,200],"page-size":e.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var l=s("VU/8")(r,a,!1,function(e){s("zFmu")},null,null);t.default=l.exports},zFmu:function(e,t){}});
//# sourceMappingURL=4.99dddcf4d4bbbf41fa8d.js.map